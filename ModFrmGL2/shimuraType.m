AttachSpec("ModFrmGL2.spec");

dir := GetCurrentDirectory();
ChangeDirectory("/Users/eranassaf/Dropbox\ \(Dartmouth\ College\)\
/Research/ModularSymbols/csg24.dat/");
// load "csg10-lev168.dat";
load "csg15-lev240.dat";
ChangeDirectory(dir);

import "congruence.m" : LoadGroups, qExpansionBasisShimura;
import "congruence.m" : LoadGroupsByGenus;
import "congruence.m" : write_qexps;

grps := LoadGroups(L);
grps_by_genus := LoadGroupsByGenus(L);

grps_g := AssociativeArray();
grps_g[3] := [grps[name] : name in grps_by_genus[3]];
grps_g[6] := [grps[name] : name in grps_by_genus[6]];
grps_g[10] := [grps[name] : name in grps_by_genus[10]];
grps_g[15] := [grps[name] : name in grps_by_genus[15]];

// groups of Shimura type for these genera
shim := AssociativeArray();
shim[6] :=  [ "11A6", "22C6", "31A6", "31B6",
            "58A6", "71A6", "79A6", "121A6" ];
shim[10] :=  [ "9A10", "18E10", "18M10", "26D10", "27B10", "28D10", "36Q10",
             "37A10", "38A10", "46A10", "54A10", "54I10", "81A10", "86A10"
             , "92A10", "108F10", "127A10" ];
shim[15] := [  "35C15", "40W15", "40X15", "43A15", "51A15", "60AC15", "60AD15", 
	     "67A15", "68D15", "80R15", "80T15", "85A15", "85B15", "102C15", "110A15", 
	     "136D15", "141A15", "153A15", "155A15", "161A15", "175A15", "179A15",
	     "193A15" ];

filtered := AssociativeArray();

filtered[3] := ["7A3", "8B3", "8A3", "9A3", "10B3", "10C3", "10A3", "12P3", 
"12F3", "12G3", "12D3", "12E3", "12A3", "12N3", "12O3", "12L3", "12J3", "12K3", 
"12I3", "13B3", "13C3", "13A3", "14D3", "14C3", "14A3", "15H3", "15F3", "15G3", 
"15E3", "15B3", "15C3", "15A3", "16R3", "16S3", "16F3", "16D3", "16E3", "16B3", 
"16C3", "16A3", "16N3", "16O3", "16L3", "16J3", "16K3", "16H3", "16I3", "18A3", 
"18J3", "18K3", "18H3", "18I3", "18F3", "18G3", "18D3", "20F3", "20G3", "20E3", 
"20A3", "20L3", "20J3", "20K3", "20H3", "20I3", "20T3", "20R3", "20S3", "20P3", 
"21D3", "21C3", "21A3", "24B3", "24C3", "24A3", "24N3", "24O3", "24L3", "24K3", 
"24H3", "24I3", "24V3", "24W3", "24U3", "24P3", "24Q3", "24Z3", "24X3", "24Y3", 
"24AC3", "24AA3", "26A3", "27C3", "27A3", "28C3", "30F3", "30G3", "30D3", 
"30B3", "30A3", "30J3", "30K3", "30H3", "30I3", "32C3", "32A3", "32N3", "32O3", 
"32L3", "32M3", "32J3", "32K3", "32P3", "32B3", "33C3", "33A3", "34B3", "34C3", 
"34A3", "35A3", "36G3", "36D3", "36E3", "36A3", "36J3", "36K3", "36I3", "39A3", 
"40F3", "40G3", "40D3", "40E3", "40C3", "40J3", "40H3", "41A3", "42D3", "42E3", 
"43A3", "45D3", "45B3", "45A3", "48F3", "48G3", "48D3", "48E3", "48C3", "48L3", 
"48M3", "48J3", "48K3", "48H3", "48I3", "49A3", "50A3", "51A3", "52B3", "54A3", 
"64B3", "64A3", "72A3" ];

    filtered[6] := ["11A6", "14B6", "17A6", "18A6", "18B6", "18C6", "20C6", "21B6", 
"21C6", "22A6", "22B6", "22C6", "24D6", "24G6", "27A6", "28D6", "28E6", "28G6", 
"28I6", "30A6", "30B6", "30C6", "30D6", "30E6", "31A6", "31B6", "32A6", "32B6", 
"35E6", "36C6", "36D6", "36E6", "36F6", "36J6", "36K6", "39A6", "45A6", "45C6", 
"45D6", "48A6", "48B6", "48C6", "48D6", "48I6", "48J6", "50E6", "52A6", "54A6", 
"54B6", "56D6", "56E6", "58A6", "60B6", "60C6", "60E6", "60F6", "63A6", "66B6", 
"66D6", "69A6", "71A6", "72B6", "72C6", "72D6", "78A6", "79A6", "86A6", "87A6", 
"90B6", "90C6", "100A6", "121A6" ];
    
    filtered[10] := ["9A10", "15A10", "15B10", "18A10", "18B10", "18C10", "18D10", 
"18E10", "18F10", "18G10", "18H10", "18L10", "18M10", "20A10", "20B10", "20C10",
"20D10", "20F10", "21A10", "22A10", "24A10", "24B10", "25A10", "26A10", "26D10",
"26E10", "27B10", "28C10", "28D10", "30A10", "30C10", "30F10", "30H10", "32B10",
"33B10", "33C10", "36A10", "36B10", "36C10", "36G10", "36I10", "36J10", "36K10",
"36M10", "36N10", "36O10", "36Q10", "36R10", "36S10", "37A10", "38A10", "39B10",
"40C10", "40D10", "40E10", "40F10", "40G10", "42A10", "42D10", "42E10", "42G10",
"42H10", "42I10", "42K10", "44B10", "44C10", "45A10", "45B10", "46A10", "48A10",
"48B10", "48C10", "48D10", "50A10", "52A10", "54A10", "54B10", "54C10", "54E10",
"54G10", "54I10", "56F10", "60C10", "72A10", "72B10", "72C10", "72D10", "74A10",
"75A10", "76A10", "78A10", "80A10", "80B10", "81A10", "84B10", "84C10", "86A10",
"88B10", "88C10", "90A10", "90D10", "90E10", "90F10", "92A10", "96A10", "96B10",
"100A10", "105A10", "108A10", "108F10", "110A10", "114A10", "114B10", "115A10", 
"118A10", "127A10", "134A10", "150A10" ];
    
    filtered[15] :=
    ;

// list of best value of M for the different groups
grps_M := [ <"11A6", 1>, <"14B6", 1>, <"17A6", 1>, <"18A6", 1>, <"18B6", 1>, <"18C6", 1>, <"20C6", 1>, <"21B6", 3>, <"21C6", 1>, <"22A6", 1>, <"22B6", 1>, <"22C6", 1>, <"24D6", 1>, <"24G6", 1>, <"27A6", 1>, <"28D6", 1>, <"28E6", 1>, <"28G6", 1>, <"28I6", 1>, <"30A6", 2>, <"30B6", 1>, <"30C6", 1>, <"30D6", 1>, <"30E6", 3>, <"31A6", 1>, <"31B6", 1>, <"32A6", 1>, <"32B6", 1>, <"35E6", 5>, <"36C6", 1>, <"36D6", 1>, <"36E6", 1>, <"36F6", 1>, <"36J6", 1>, <"36K6", 1>, <"39A6", 1>, <"45A6", 1>, <"45C6", 1>, <"45D6", 1>, <"48A6", 1>, <"48B6", 1>, <"48C6", 1>, <"48D6", 1>, <"48I6", 1>, <"48J6", 1>, <"50E6", 1>, <"52A6", 1>, <"54A6", 1>, <"54B6", 1>, <"56D6", 1>, <"56E6", 1>, <"58A6", 58>, <"60B6", 1>, <"60C6", 1>, <"60E6", 1>, <"60F6", 1>, <"63A6", 7>, <"66B6", 11>, <"66D6", 11>, <"69A6", 23>, <"71A6", 71>, <"72B6", 1>, <"72C6", 1>, <"72D6", 1>, <"78A6", 1>, <"79A6", 79>, <"86A6", 43>, <"87A6", 29>, <"90B6", 1>, <"90C6", 1>, <"100A6", 1>, <"121A6", 121> ];

SetDebugOnError(true);

procedure computeShimuraModularCurves(shim, grps)

    for g in [6,10,15] do
	for name in shim[g] do
	    X, fs := qExpansionBasisShimura(name, grps);
	    write_qexps(name cat "_shim", fs, X);
	    print "Group ", name, " - done!";
	end for;
    end for;
    
end procedure;

